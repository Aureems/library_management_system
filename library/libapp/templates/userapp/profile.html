{% extends 'base.html' %}
{% load static %}
{% block content %}

{% include 'navbar.html' %}
<style>
    body{margin-top:20px;}
</style>

<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<hr>
<div class="container">
    <div class="row ml-2"><h4>{{ user.username }}</h4></div>
    <div class="row">
        <div class="col-sm-3">
            <!--left col-->
            <ul class="list-group">
            <a href="#">
                <li class="list-group-item text-muted">Profile
                    <i class="fa fa-user-circle-o" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="View details"></i>
                </li>
            </a>
                <li class="list-group-item text-right"><span class="float-left"><strong>Joined</strong></span>
                    {{ user.date_joined|date:'Y-m-d'}}</li>
                <li class="list-group-item text-right"><span class="float-left"><strong>Last seen</strong></span>
                    {{ user.last_login|date:'Y-m-d h:i a'}}</li>
                <li class="list-group-item text-right"><span class="float-left"><strong>Full name</strong></span>
                    {{ user.first_name}} {{ user.last_name }}</li>
                <li class="list-group-item text-right"><span class="float-left"><strong>User type</strong></span>
                    {% if user.is_staff %}
                        Admin
                    {% else %}
                        {% if user.is_customer %}
                            Customer
                        {% else %}
                            Librarian
                        {% endif %}
                    {% endif %}
                </li>
            </ul>

            {% if not user.is_librarian %}
            <ul class="list-group">
                <li class="list-group-item text-muted">Activity <i class="fa fa-dashboard" aria-hidden="true"></i></li>
                <li class="list-group-item text-right"><span class="float-left"><strong>Total ordered books</strong></span>
                    {{ total_books }}</li>
                <li class="list-group-item text-right"><span class="float-left"><strong>Reading</strong></span>
                    {{ total_not_returned }}</li>
            </ul>
            {% endif %}

        </div>
        <!--/col-3-->
        <div class="col-sm-9">
            <ul class="nav nav-tabs" id="myTab">
                <a class="nav-link active" id="home" href="#home" data-toggle="tab">My books</a>
            </ul>

            <div class="tab-content">
                <div class="tab-pane active" id="home">
                    <div class="table-responsive">
                        <table class="table table-hover"  style="font-size:13px">
                            <thead>

                                <tr>
{#                                    <th scope="col">No.</th>#}
                                    <th scope="col">Title</th>
                                    <th scope="col">Author</th>
                                    <th scope="col">Page number</th>
                                    <th scope="col">Ordered from</th>
                                    <th scope="col">Ordered until</th>
                                </tr>
                            </thead>
                            <tbody id="items">

                                {% for order in active_orders %}
                                    {% for order_item in order.items.all %}
{#                                      <th scope="row">{{ forloop.parentloop.counter }}</th>#}
                                      {% if not order_item.date_returned %}
                                      <td>{{ order_item.item.title }}</td>
                                      <td>{{ order_item.item.author}}</td>
                                      <td>{{ order_item.item.page_number}}</td>
                                      <td>{{ order_item.date_ordered|date:'Y-m-d H:m'}}</td>
                                      <td>{{ order.until_date|date:'Y-m-d H:m'}}
                                          <a href={% url 'book-return' order_item.id %}>
                                              <i class="fa fa-refresh" data-toggle="tooltip" data-placement="top" title="Return"></i>
                                          </a>
                                      </td>
                                        {% endif %}
                                    </tr>
                                    {% endfor %}
                            {% endfor %}

                            </tbody>
                        </table>
                        <hr>
                        <div class="row">
                            <div class="col-md-4 col-md-offset-4 text-center">
                                <ul class="pagination" id="myPager"></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


{% include 'footer.html' %}
{% endblock %}